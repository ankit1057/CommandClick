#!/data/data/com.puutaro.commandclick/files/support/busybox sh

## !/support/common/busybox_static sh

# if [ ! -f /support/rootfs.tar.gz ]; then
#    /support/common/busybox_static cat /support/rootfs.tar.gz.part* > /support/rootfs.tar.gz
#    /support/common/busybox_static rm -f /support/rootfs.tar.gz.part*
# fi

# ln -s /support/common/busybox_static /support/gzip
# /support/common/gzip
# export PATH=/support/gzip:$PATH

files_dir="/data/data/com.puutaro.commandclick/files/"
rootfs_dir="/data/data/com.puutaro.commandclick/files/1/rootfs/"
cd "${files_dir}"
echo extract
echo --pwd
pwd
echo -- /data/data/com.puutaro.commandclick/files/support/busybox sh
/data/data/com.puutaro.commandclick/files/support/busybox sh -c ls
echo --ls
ls

echo -- tar command
tar -xzvf rootfs.tar.gz \
--exclude sys \
--exclude dev \
--exclude proc \
--exclude mnt \
--exclude support \
-C "${rootfs_dir}"
# > /dev/null

mkdir "${rootfs_dir}/external"

echo -- ls "${rootfs_dir}"
ls "${rootfs_dir}"

# if [[ $? == 0 ]]; then
# 	/support/common/addNonRootUser.sh
# 	/support/common/busybox_static rm /support/rootfs.tar.gz
# 	/support/common/busybox_static touch /support/.success_filesystem_extraction
# else
# 	/support/common/busybox_static touch /support/.failure_filesystem_extraction
# fi
